package mmo.common.module.clazz.charge.callback;

import java.io.BufferedOutputStream;
import java.io.BufferedReader;
import java.io.InputStream;
import java.io.InputStreamReader;
import java.net.HttpURLConnection;
import java.net.URL;
import java.util.Date;
import java.util.Locale;

import net.sf.json.JSONObject;

/**
 * 用于去IOS验证购买凭证，用Base64编码然后POST给苹果的验证服务器，苹果将验证结果以JSON形式返回。 21000
 * 应用程序商店不能阅读你提供的JSON对象。 21002 中的数据receipt-data财产是畸形或失踪。 21003 收据不能验证。 21004
 * 你提供的共享密钥不匹配的共享密钥文件您的帐户。 21005 目前没有收到服务器。 21006
 * 这个收据是有效的但订阅已过期。当这种状态码返回给服务器,接收数据解码和返回的响应。 21007 这个收据是测试环境,但它被发送到生产环境验证。
 * 将其发送到测试环境。 21008 这个收据是生产环境,但是它被发送到测试环境验证。 将其发送到生产环境中。
 * 
 * @author hzw
 * @date 2015-6-20下午8:28:03
 */
public class verifyUtil {

	private static final String url_sandbox = "https://sandbox.itunes.apple.com/verifyReceipt";
	private static final String url_verify = "https://buy.itunes.apple.com/verifyReceipt";

	
	public static void main(String[] args) {
		String str = "";
		BufferedOutputStream urlBufOus = null;
		InputStream in = null;
		try {
			URL console = new URL(url_sandbox);
			HttpURLConnection conn = (HttpURLConnection) console.openConnection();
			conn.setRequestMethod("POST");
			conn.setRequestProperty("content-type", "text/json");
			conn.setRequestProperty("Proxy-Connection", "Keep-Alive");
			conn.setDoInput(true);
			conn.setDoOutput(true);
//			conn.setConnectTimeout(3000);
//			conn.setReadTimeout(3000);
			urlBufOus = new BufferedOutputStream(conn.getOutputStream());
			String rep = String.format(Locale.CHINA, "{\"receipt-data\":\"" + "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" + "\"}");
//			System.out.println("===rep==="+rep);
			urlBufOus.write(rep.getBytes());
			urlBufOus.flush();

			in = conn.getInputStream();
			BufferedReader reader = new BufferedReader(new InputStreamReader(in));
			String line = null;
			while ((line = reader.readLine()) != null) {
				str += line;
			}
			System.out.println(str);
			JSONObject json =  JSONObject.fromObject(str);
		} catch (Exception e) {
			// TODO: handle exception
		}
	}
	
	/**
	 * 苹果服务器验证
	 * @param receipt
	 * @verifyState 要验证的地址标示
	 * @return null 或返回结果
	 */
	@SuppressWarnings({ "null", "finally" })
	public static String buyAppVerify(){
		
		String url = url_sandbox; 
//		int urlType = ConvertUtil.toInt(SysConfigUtil.getValue("urlType"));
//		if (urlType != 0) {
//			url = url_verify; 
//		}
		
		/*Map<String, String> jsonMap = new HashMap<String, String>();
		jsonMap.put("receipt-data", recharge.getReceipt());
		String param = JsonUtil.toJson(jsonMap);
		String result = "";
		try {
			result = HttpClientUtil.postSubmit(url, param);
		} catch (Exception e) {
			e.printStackTrace();
		}
		System.out.println("param == " + param);*/
		String str = "";
		BufferedOutputStream urlBufOus = null;
		InputStream in = null;
		try {
			URL console = new URL(url);
			HttpURLConnection conn = (HttpURLConnection) console.openConnection();
			conn.setRequestMethod("POST");
			conn.setRequestProperty("content-type", "text/json");
			conn.setRequestProperty("Proxy-Connection", "Keep-Alive");
			conn.setDoInput(true);
			conn.setDoOutput(true);
//			conn.setConnectTimeout(3000);
//			conn.setReadTimeout(3000);
			urlBufOus = new BufferedOutputStream(conn.getOutputStream());
			String rep = String.format(Locale.CHINA, "{\"receipt-data\":\"" + 1 + "\"}");
//			System.out.println("===rep==="+rep);
			urlBufOus.write(rep.getBytes());
			urlBufOus.flush();

			in = conn.getInputStream();
			BufferedReader reader = new BufferedReader(new InputStreamReader(in));
			String line = null;
			while ((line = reader.readLine()) != null) {
				str += line;
			}
			JSONObject json =  JSONObject.fromObject(str);
			
//			System.out.println(recharge.getPlayerId() + "+++++++结果码++++++" + json.get("status"));
//			recharge.setRegState(ConvertUtil.toInt(json.get("status").toString()));
			
			//加入日志
//			LogUtil.info(recharge.getPlayerId() + "#" + recharge.getPlayerName() + "#" + recharge.getChType() + "#" + recharge.getOrderNum() + "#" + recharge.getReceipt() + "#" + recharge.getRegState() + "#" + recharge.getServerId() + "#" + json.get("status") + "#" + new java.text.SimpleDateFormat("yyyy-MM-dd HH:mm:ss").format(new Date()));
			
//			IosQueue.inform(recharge);
		} catch (Exception ex) {
			ex.printStackTrace();
		} finally {
			if (str == null && str.equals("")) {
//				try {
////					IosQueue.getQueue().put(recharge);
//				} catch (InterruptedException e) {
//					e.printStackTrace();
//				}
			}
			return str;
		}
	}

	/**
	 * 用BASE64加密
	 * 
	 * @param str
	 * @return
	 */
	public static String getBASE64(String str) {
		byte[] b = str.getBytes();
		String s = null;
		if (b != null) {
			s = new sun.misc.BASE64Encoder().encode(b);
		}
		return s;
	}

}
